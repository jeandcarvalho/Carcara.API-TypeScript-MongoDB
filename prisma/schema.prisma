// CarCar√° ¬∑ Prisma schema for big_1hz (MongoDB)


generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Visiter {
  id         String    @id @map("_id")
  visitantes Int
  @@map("VisitsCounter")
}

model FilesProcessed {
  id         String @id @map("_id")
  FileName   String
  Timestamp  String
  GPS_x      String
  GPS_y      String
  City       String
  Country    String
  District   String
  State      String
  Street     String
  IMU        String 
  OBII       String
  Radar      String
  Csv        String
  Mf4        String
  VIEW360    String @map("360VIEW")
  CAM_Front_Center String
  CAM_Front_Left   String
  CAM_Front_Right  String
  CAM_Rear_Center  String
  CAM_Rear_Left    String
  CAM_Rear_Right   String
  Area       String  
  Misc       String
  Period     String
  RoadType   String @map("Road Type")
  Traffic    String
  Weather    String
  @@map("FilesProcessed")
}

model Big1Hz {
  id         String    @id @default(auto()) @map("_id") @db.ObjectId

  acq_id     Int?
  acq_name   String?
  acq_id_raw String?

  sec        Int

  block      BlockSub?
  can        CanSub?
  laneego    LaneegoSub?
  overpass   OverpassSub?
  semseg     SemsegSub?
  yolo       YoloDet[]
  links      LinkFile[]

  @@map("big_1hz")
  @@index([acq_id, sec])
  @@index([block.vehicle])
  @@index([block.meteo.period])
  @@index([block.meteo.condition])
  @@index([overpass.highway])
  @@index([overpass.landuse])
}

type BlockSub {
  vehicle String?
  meteo   MeteoSub?
}

type MeteoSub {
  period    String?
  condition String?
}

type CanSub {
  GPS_x              Float?
  GPS_y              Float?
  GPS_z              Float?
  VehicleSpeed       Float?
  SteeringWheelAngle Float?
  BrakeInfoStatus    String?
}

type LaneegoSub {
  left_disp  String?
  right_disp String?
}

type OverpassSub {
  city     String?
  state    String?
  country  String?
  suburb   String?

  road     String?
  highway  String?
  landuse  String?

  lanes    Float?
  maxspeed Float?

  oneway   String?
  surface  String?
  sidewalk String?
  cycleway String?
}

type SemsegSub {
  building      Float?
  vegetation    Float?
  sidewalk_left Float?
  sidewalk_right Float?
}

type YoloDet {
  frame_idx Int?
  fps       Float?

  track_id  Int?
  class     String?
  conf      Float?

  x1        Float?
  y1        Float?
  x2        Float?
  y2        Float?
  w         Float?
  h         Float?

  dist_m    Float?
  geom_idx  Float?
  rel_to_ego String?
  in_frac   Float?
}

type LinkFile {
  ext  String?
  link String?
}

model User {
  id           String        @id @default(auto()) @map("_id") @db.ObjectId
  name         String?
  email        String        @unique
  passwordHash String
  createdAt    DateTime      @default(now())

  collections  Collection[]
}

model Collection {
  id          String         @id @default(auto()) @map("_id") @db.ObjectId
  userId      String         @db.ObjectId
  user        User           @relation(fields: [userId], references: [id])
  name        String
  description String?
  createdAt   DateTime       @default(now())

  items       CollectionItem[]
}

model CollectionItem {
  id           String      @id @default(auto()) @map("_id") @db.ObjectId
  collectionId String      @db.ObjectId
  collection   Collection  @relation(fields: [collectionId], references: [id])

  acq_id       String
  sec          Int
  createdAt    DateTime    @default(now())
}


model Links {
  id     String  @id @default(auto()) @map("_id") @db.ObjectId
  acq_id String
  sec    Int?
  ext    String
  link   String

  @@map("links")   // üëà garante que o Prisma use a cole√ß√£o "links"
}

model LLMResult {
  id           String   @id @default(auto()) @map("_id") @db.ObjectId

  // aqui √© string simples, igual est√° no banco hoje
  collectionId String   @map("collectionId")

  acq_id       String

  // se ainda n√£o tiver `sec` nos docs antigos, tudo bem pra leitura
  sec          Int

  // mapeia snake_case -> camelCase
  testName     String   @map("test_name")
  llmModel     String   @map("llm_model")
  promptType   String   @map("prompt_type")

  // mapeia prompt/answer e m√©tricas
  prompt       String?  @map("prompt_text")
  response     String?  @map("answer")
  totalTokens  Int?     @map("total_tokens")
  latencyMs    Int?     @map("response_time_s")

  createdAt    DateTime @default(now())
}






